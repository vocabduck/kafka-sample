@Component
@StepScope
public class UpdateRefTableTasklet implements Tasklet {

    @Autowired
    private EsalesISGDataRepository esalesISGDataRepository;

    @Override
    public RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) {

        int updatedCount = esalesISGDataRepository.markAllPendingAsProcessed(); // returns updated row count if defined that way

        System.out.println("Updated " + updatedCount + " rows to isProcessed = 'T'");

        return RepeatStatus.FINISHED;
    }
}
@Transactional
@Modifying
@Query("UPDATE EsalesData e SET e.isProcessed = 'T' WHERE e.isProcessed = 'F'")
int markAllPendingAsProcessed();  // returns row count


@Bean(name = "updateRefIsProcessedStep")
public Step updateRefIsProcessedStep(JobRepository jobRepository,
                                     PlatformTransactionManager transactionManager,
                                     UpdateRefTableTasklet updateRefTableTasklet) {

    StepBuilder builder = new StepBuilder("updateRefIsProcessedStep", jobRepository);

    return builder
            .tasklet(updateRefTableTasklet, transactionManager)
            .build();
}
